function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=e.parcelRequire2fee;null==i&&((i=function(t){if(t in n)return n[t].exports;if(t in r){var e=r[t];delete r[t];var i={id:t,exports:{}};return n[t]=i,e.call(i.exports,i,i.exports),i.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){r[t]=e},e.parcelRequire2fee=i),i.register("ByIgr",(function(e,n){t(e.exports,"default",(()=>u),(t=>u=t));var r=i("2wtYk"),a="object"==typeof n&&n&&!n.nodeType&&n,o=a&&e&&!e.nodeType&&e,h=o&&o.exports===a?s.Buffer:void 0,u=(h?h.isBuffer:void 0)||r.default}));var a="object"==typeof e&&e&&e.Object===Object&&e,o="object"==typeof self&&self&&self.Object===Object&&self,s=a||o||Function("return this")();i.register("2wtYk",(function(e,n){t(e.exports,"default",(()=>r));var r=function(){return!1}})),i.register("i9OtR",(function(e,n){t(e.exports,"default",(()=>s),(t=>s=t));var r="object"==typeof n&&n&&!n.nodeType&&n,i=r&&e&&!e.nodeType&&e,o=i&&i.exports===r&&a.process,s=function(){try{var t=i&&i.require&&i.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}()}));var h=s.Symbol,u=Object.prototype,l=u.hasOwnProperty,c=u.toString,f=h?h.toStringTag:void 0;var d=function(t){var e=l.call(t,f),n=t[f];try{t[f]=void 0;var r=!0}catch(t){}var i=c.call(t);return r&&(e?t[f]=n:delete t[f]),i},g=Object.prototype.toString;var v=function(t){return g.call(t)},p=h?h.toStringTag:void 0;var m=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":p&&p in Object(t)?d(t):v(t)};var y=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var _,E=function(t){if(!y(t))return!1;var e=m(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},b=s["__core-js_shared__"],S=(_=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"";var A=function(t){return!!S&&S in t},w=Function.prototype.toString;var O=function(t){if(null!=t){try{return w.call(t)}catch(t){}try{return t+""}catch(t){}}return""},C=/^\[object .+?Constructor\]$/,T=Function.prototype,j=Object.prototype,L=T.toString,N=j.hasOwnProperty,x=RegExp("^"+L.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var M=function(t){return!(!y(t)||A(t))&&(E(t)?x:C).test(O(t))};var R=function(t,e){return null==t?void 0:t[e]};var G=function(t,e){var n=R(t,e);return M(n)?n:void 0},I=function(){try{var t=G(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var P=function(t,e,n){"__proto__"==e&&I?I(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n};var D=function(t,e,n,r){for(var i=-1,a=null==t?0:t.length;++i<a;){var o=t[i];e(r,o,n(o),t)}return r};var F=function(t){return function(e,n,r){for(var i=-1,a=Object(e),o=r(e),s=o.length;s--;){var h=o[t?s:++i];if(!1===n(a[h],h,a))break}return e}}();var B=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var z=function(t){return null!=t&&"object"==typeof t};var U=function(t){return z(t)&&"[object Arguments]"==m(t)},k=Object.prototype,$=k.hasOwnProperty,q=k.propertyIsEnumerable,W=U(function(){return arguments}())?U:function(t){return z(t)&&$.call(t,"callee")&&!q.call(t,"callee")},V=Array.isArray,H=i("ByIgr"),K=/^(?:0|[1-9]\d*)$/;var Z=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&K.test(t))&&t>-1&&t%1==0&&t<e};var J=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Y={};Y["[object Float32Array]"]=Y["[object Float64Array]"]=Y["[object Int8Array]"]=Y["[object Int16Array]"]=Y["[object Int32Array]"]=Y["[object Uint8Array]"]=Y["[object Uint8ClampedArray]"]=Y["[object Uint16Array]"]=Y["[object Uint32Array]"]=!0,Y["[object Arguments]"]=Y["[object Array]"]=Y["[object ArrayBuffer]"]=Y["[object Boolean]"]=Y["[object DataView]"]=Y["[object Date]"]=Y["[object Error]"]=Y["[object Function]"]=Y["[object Map]"]=Y["[object Number]"]=Y["[object Object]"]=Y["[object RegExp]"]=Y["[object Set]"]=Y["[object String]"]=Y["[object WeakMap]"]=!1;var X=function(t){return z(t)&&J(t.length)&&!!Y[m(t)]};var Q=function(t){return function(e){return t(e)}},tt=i("i9OtR"),et=tt.default&&tt.default.isTypedArray,nt=et?Q(et):X,rt=Object.prototype.hasOwnProperty;var it=function(t,e){var n=V(t),r=!n&&W(t),i=!n&&!r&&H.default(t),a=!n&&!r&&!i&&nt(t),o=n||r||i||a,s=o?B(t.length,String):[],h=s.length;for(var u in t)!e&&!rt.call(t,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Z(u,h))||s.push(u);return s},at=Object.prototype;var ot=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||at)};var st=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),ht=Object.prototype.hasOwnProperty;var ut=function(t){if(!ot(t))return st(t);var e=[];for(var n in Object(t))ht.call(t,n)&&"constructor"!=n&&e.push(n);return e};var lt=function(t){return null!=t&&J(t.length)&&!E(t)};var ct=function(t){return lt(t)?it(t):ut(t)};var ft=function(t,e){return function(n,r){if(null==n)return n;if(!lt(n))return t(n,r);for(var i=n.length,a=e?i:-1,o=Object(n);(e?a--:++a<i)&&!1!==r(o[a],a,o););return n}}((function(t,e){return t&&F(t,e,ct)}));var dt=function(t,e,n,r){return ft(t,(function(t,i,a){e(r,t,n(t),a)})),r};var gt=function(){this.__data__=[],this.size=0};var vt=function(t,e){return t===e||t!=t&&e!=e};var pt=function(t,e){for(var n=t.length;n--;)if(vt(t[n][0],e))return n;return-1},mt=Array.prototype.splice;var yt=function(t){var e=this.__data__,n=pt(e,t);return!(n<0)&&(n==e.length-1?e.pop():mt.call(e,n,1),--this.size,!0)};var _t=function(t){var e=this.__data__,n=pt(e,t);return n<0?void 0:e[n][1]};var Et=function(t){return pt(this.__data__,t)>-1};var bt=function(t,e){var n=this.__data__,r=pt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function St(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}St.prototype.clear=gt,St.prototype.delete=yt,St.prototype.get=_t,St.prototype.has=Et,St.prototype.set=bt;var At=St;var wt=function(){this.__data__=new At,this.size=0};var Ot=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var Ct=function(t){return this.__data__.get(t)};var Tt=function(t){return this.__data__.has(t)},jt=G(s,"Map"),Lt=G(Object,"create");var Nt=function(){this.__data__=Lt?Lt(null):{},this.size=0};var xt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Mt=Object.prototype.hasOwnProperty;var Rt=function(t){var e=this.__data__;if(Lt){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Mt.call(e,t)?e[t]:void 0},Gt=Object.prototype.hasOwnProperty;var It=function(t){var e=this.__data__;return Lt?void 0!==e[t]:Gt.call(e,t)};var Pt=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Lt&&void 0===e?"__lodash_hash_undefined__":e,this};function Dt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Dt.prototype.clear=Nt,Dt.prototype.delete=xt,Dt.prototype.get=Rt,Dt.prototype.has=It,Dt.prototype.set=Pt;var Ft=Dt;var Bt=function(){this.size=0,this.__data__={hash:new Ft,map:new(jt||At),string:new Ft}};var zt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Ut=function(t,e){var n=t.__data__;return zt(e)?n["string"==typeof e?"string":"hash"]:n.map};var kt=function(t){var e=Ut(this,t).delete(t);return this.size-=e?1:0,e};var $t=function(t){return Ut(this,t).get(t)};var qt=function(t){return Ut(this,t).has(t)};var Wt=function(t,e){var n=Ut(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function Vt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Vt.prototype.clear=Bt,Vt.prototype.delete=kt,Vt.prototype.get=$t,Vt.prototype.has=qt,Vt.prototype.set=Wt;var Ht=Vt;var Kt=function(t,e){var n=this.__data__;if(n instanceof At){var r=n.__data__;if(!jt||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ht(r)}return n.set(t,e),this.size=n.size,this};function Zt(t){var e=this.__data__=new At(t);this.size=e.size}Zt.prototype.clear=wt,Zt.prototype.delete=Ot,Zt.prototype.get=Ct,Zt.prototype.has=Tt,Zt.prototype.set=Kt;var Jt=Zt;var Yt=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var Xt=function(t){return this.__data__.has(t)};function Qt(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Ht;++e<n;)this.add(t[e])}Qt.prototype.add=Qt.prototype.push=Yt,Qt.prototype.has=Xt;var te=Qt;var ee=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1};var ne=function(t,e){return t.has(e)};var re=function(t,e,n,r,i,a){var o=1&n,s=t.length,h=e.length;if(s!=h&&!(o&&h>s))return!1;var u=a.get(t),l=a.get(e);if(u&&l)return u==e&&l==t;var c=-1,f=!0,d=2&n?new te:void 0;for(a.set(t,e),a.set(e,t);++c<s;){var g=t[c],v=e[c];if(r)var p=o?r(v,g,c,e,t,a):r(g,v,c,t,e,a);if(void 0!==p){if(p)continue;f=!1;break}if(d){if(!ee(e,(function(t,e){if(!ne(d,e)&&(g===t||i(g,t,n,r,a)))return d.push(e)}))){f=!1;break}}else if(g!==v&&!i(g,v,n,r,a)){f=!1;break}}return a.delete(t),a.delete(e),f},ie=s.Uint8Array;var ae=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n};var oe=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},se=h?h.prototype:void 0,he=se?se.valueOf:void 0;var ue=function(t,e,n,r,i,a,o){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new ie(t),new ie(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return vt(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=ae;case"[object Set]":var h=1&r;if(s||(s=oe),t.size!=e.size&&!h)return!1;var u=o.get(t);if(u)return u==e;r|=2,o.set(t,e);var l=re(s(t),s(e),r,i,a,o);return o.delete(t),l;case"[object Symbol]":if(he)return he.call(t)==he.call(e)}return!1};var le=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t};var ce=function(t,e,n){var r=e(t);return V(t)?r:le(r,n(t))};var fe=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,a=[];++n<r;){var o=t[n];e(o,n,t)&&(a[i++]=o)}return a};var de=function(){return[]},ge=Object.prototype.propertyIsEnumerable,ve=Object.getOwnPropertySymbols,pe=ve?function(t){return null==t?[]:(t=Object(t),fe(ve(t),(function(e){return ge.call(t,e)})))}:de;var me=function(t){return ce(t,ct,pe)},ye=Object.prototype.hasOwnProperty;var _e=function(t,e,n,r,i,a){var o=1&n,s=me(t),h=s.length;if(h!=me(e).length&&!o)return!1;for(var u=h;u--;){var l=s[u];if(!(o?l in e:ye.call(e,l)))return!1}var c=a.get(t),f=a.get(e);if(c&&f)return c==e&&f==t;var d=!0;a.set(t,e),a.set(e,t);for(var g=o;++u<h;){var v=t[l=s[u]],p=e[l];if(r)var m=o?r(p,v,l,e,t,a):r(v,p,l,t,e,a);if(!(void 0===m?v===p||i(v,p,n,r,a):m)){d=!1;break}g||(g="constructor"==l)}if(d&&!g){var y=t.constructor,_=e.constructor;y==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(d=!1)}return a.delete(t),a.delete(e),d},Ee=G(s,"DataView"),be=G(s,"Promise"),Se=G(s,"Set"),Ae=G(s,"WeakMap"),we=O(Ee),Oe=O(jt),Ce=O(be),Te=O(Se),je=O(Ae),Le=m;(Ee&&"[object DataView]"!=Le(new Ee(new ArrayBuffer(1)))||jt&&"[object Map]"!=Le(new jt)||be&&"[object Promise]"!=Le(be.resolve())||Se&&"[object Set]"!=Le(new Se)||Ae&&"[object WeakMap]"!=Le(new Ae))&&(Le=function(t){var e=m(t),n="[object Object]"==e?t.constructor:void 0,r=n?O(n):"";if(r)switch(r){case we:return"[object DataView]";case Oe:return"[object Map]";case Ce:return"[object Promise]";case Te:return"[object Set]";case je:return"[object WeakMap]"}return e});var Ne=Le,xe=(H=i("ByIgr"),Object.prototype.hasOwnProperty);var Me=function(t,e,n,r,i,a){var o=V(t),s=V(e),h=o?"[object Array]":Ne(t),u=s?"[object Array]":Ne(e),l="[object Object]"==(h="[object Arguments]"==h?"[object Object]":h),c="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),f=h==u;if(f&&H.default(t)){if(!H.default(e))return!1;o=!0,l=!1}if(f&&!l)return a||(a=new Jt),o||nt(t)?re(t,e,n,r,i,a):ue(t,e,h,n,r,i,a);if(!(1&n)){var d=l&&xe.call(t,"__wrapped__"),g=c&&xe.call(e,"__wrapped__");if(d||g){var v=d?t.value():t,p=g?e.value():e;return a||(a=new Jt),i(v,p,n,r,a)}}return!!f&&(a||(a=new Jt),_e(t,e,n,r,i,a))};var Re=function t(e,n,r,i,a){return e===n||(null==e||null==n||!z(e)&&!z(n)?e!=e&&n!=n:Me(e,n,r,i,t,a))};var Ge=function(t,e,n,r){var i=n.length,a=i,o=!r;if(null==t)return!a;for(t=Object(t);i--;){var s=n[i];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){var h=(s=n[i])[0],u=t[h],l=s[1];if(o&&s[2]){if(void 0===u&&!(h in t))return!1}else{var c=new Jt;if(r)var f=r(u,l,h,t,e,c);if(!(void 0===f?Re(l,u,3,r,c):f))return!1}}return!0};var Ie=function(t){return t==t&&!y(t)};var Pe=function(t){for(var e=ct(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Ie(i)]}return e};var De=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}};var Fe=function(t){var e=Pe(t);return 1==e.length&&e[0][2]?De(e[0][0],e[0][1]):function(n){return n===t||Ge(n,t,e)}};var Be=function(t){return"symbol"==typeof t||z(t)&&"[object Symbol]"==m(t)},ze=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ue=/^\w*$/;var ke=function(t,e){if(V(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Be(t))||(Ue.test(t)||!ze.test(t)||null!=e&&t in Object(e))};function $e(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=t.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new($e.Cache||Ht),n}$e.Cache=Ht;var qe=$e;var We=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ve=/\\(\\)?/g,He=function(t){var e=qe(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(We,(function(t,n,r,i){e.push(r?i.replace(Ve,"$1"):n||t)})),e}));var Ke=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i},Ze=h?h.prototype:void 0,Je=Ze?Ze.toString:void 0;var Ye=function t(e){if("string"==typeof e)return e;if(V(e))return Ke(e,t)+"";if(Be(e))return Je?Je.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n};var Xe=function(t){return null==t?"":Ye(t)};var Qe=function(t,e){return V(t)?t:ke(t,e)?[t]:He(Xe(t))};var tn=function(t){if("string"==typeof t||Be(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var en=function(t,e){for(var n=0,r=(e=Qe(e,t)).length;null!=t&&n<r;)t=t[tn(e[n++])];return n&&n==r?t:void 0};var nn=function(t,e,n){var r=null==t?void 0:en(t,e);return void 0===r?n:r};var rn=function(t,e){return null!=t&&e in Object(t)};var an=function(t,e,n){for(var r=-1,i=(e=Qe(e,t)).length,a=!1;++r<i;){var o=tn(e[r]);if(!(a=null!=t&&n(t,o)))break;t=t[o]}return a||++r!=i?a:!!(i=null==t?0:t.length)&&J(i)&&Z(o,i)&&(V(t)||W(t))};var on=function(t,e){return null!=t&&an(t,e,rn)};var sn=function(t,e){return ke(t)&&Ie(e)?De(tn(t),e):function(n){var r=nn(n,t);return void 0===r&&r===e?on(n,t):Re(e,r,3)}};var hn=function(t){return t};var un=function(t){return function(e){return null==e?void 0:e[t]}};var ln=function(t){return function(e){return en(e,t)}};var cn=function(t){return ke(t)?un(tn(t)):ln(t)};var fn=function(t){return"function"==typeof t?t:null==t?hn:"object"==typeof t?V(t)?sn(t[0],t[1]):Fe(t):cn(t)};var dn=function(t,e){return function(n,r){var i=V(n)?D:dt,a=e?e():{};return i(n,t,fn(r,2),a)}},gn=Object.prototype.hasOwnProperty,vn=dn((function(t,e,n){gn.call(t,n)?++t[n]:P(t,n,1)})),pn=Math.floor,mn=Math.random;var yn=function(t,e){return t+pn(mn()*(e-t+1))};var _n=function(t,e,n){if(!y(n))return!1;var r=typeof e;return!!("number"==r?lt(n)&&Z(e,n.length):"string"==r&&e in n)&&vt(n[e],t)},En=/\s/;var bn=function(t){for(var e=t.length;e--&&En.test(t.charAt(e)););return e},Sn=/^\s+/;var An=function(t){return t?t.slice(0,bn(t)+1).replace(Sn,""):t},wn=/^[-+]0x[0-9a-f]+$/i,On=/^0b[01]+$/i,Cn=/^0o[0-7]+$/i,Tn=parseInt;var jn=function(t){if("number"==typeof t)return t;if(Be(t))return NaN;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=An(t);var n=On.test(t);return n||Cn.test(t)?Tn(t.slice(2),n?2:8):wn.test(t)?NaN:+t};var Ln=function(t){return t?Infinity===(t=jn(t))||-Infinity===t?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0},Nn=parseFloat,xn=Math.min,Mn=Math.random;var Rn=function(t,e,n){if(n&&"boolean"!=typeof n&&_n(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=Ln(t),void 0===e?(e=t,t=0):e=Ln(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=Mn();return xn(t+i*(e-t+Nn("1e-"+((i+"").length-1))),e)}return yn(t,e)},Gn=Math.ceil,In=Math.max;var Pn=function(t,e,n,r){for(var i=-1,a=In(Gn((e-t)/(n||1)),0),o=Array(a);a--;)o[r?a:++i]=t,t+=n;return o};var Dn=function(t){return function(e,n,r){return r&&"number"!=typeof r&&_n(e,n,r)&&(n=r=void 0),e=Ln(e),void 0===n?(n=e,e=0):n=Ln(n),r=void 0===r?e<n?1:-1:Ln(r),Pn(e,n,r,t)}}();var Fn=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};var Bn=function(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var a=Array(i);++r<i;)a[r]=t[r+e];return a};var zn=function(t,e){return e.length<2?t:en(t,Bn(e,0,-1))};var Un=function(t,e){return e=Qe(e,t),null==(t=zn(t,e))||delete t[tn(Fn(e))]},kn=Array.prototype.splice;var $n=function(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==a){var a=i;Z(i)?kn.call(t,i,1):Un(t,i)}}return t};var qn=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],a=t.length;for(e=fn(e,3);++r<a;){var o=t[r];e(o,r,t)&&(n.push(o),i.push(r))}return $n(t,i),n};var Wn=function(t){var e=t.length;return e?t[yn(0,e-1)]:void 0};var Vn=function(t,e){return Ke(e,(function(e){return t[e]}))};var Hn=function(t){return null==t?[]:Vn(t,ct(t))};var Kn=function(t){return Wn(Hn(t))};var Zn=function(t){return(V(t)?Wn:Kn)(t)};var Jn=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e};var Yn=function(t,e){var n=-1,r=t.length,i=r-1;for(e=void 0===e?r:e;++n<e;){var a=yn(n,i),o=t[a];t[a]=t[n],t[n]=o}return t.length=e,t};var Xn=function(t){return Yn(Jn(t))};var Qn=function(t){return Yn(Hn(t))};var tr=function(t){return(V(t)?Xn:Qn)(t)};class er{addObserver(t){this.observers.push(t)}removeObserver(t){qn(this.observers,(e=>e===t))}constructor(){this.observers=[]}}class nr extends er{notifyObservers(t,e){this.observers.forEach((n=>n.positionChanged(t,e,this)))}}class rr extends er{notifyObservers(t){this.observers.forEach((e=>e.configSubmitted(t)))}}class ir extends er{notifyObservers(t){this.observers.forEach((e=>e.canvasClicked(t)))}}class ar{constructor(t,e){this.x=t,this.y=e}toString(){return`(${this.x}, ${this.y})`}add(t){return new ar(this.x+t.x,this.y+t.y)}toArray(){return[this.x,this.y]}equals(t){return t instanceof ar&&(this.x===t.x&&this.y===t.y)}}let or;!function(t){t[t.North=0]="North",t[t.NorthEast=1]="NorthEast",t[t.East=2]="East",t[t.SouthEast=3]="SouthEast",t[t.South=4]="South",t[t.SouthWest=5]="SouthWest",t[t.West=6]="West",t[t.NorthWest=7]="NorthWest",t[t.__Length=8]="__Length"}(or||(or={}));class sr{static get randomDirection(){return Rn(or.__Length-1)}static toString(t){return or[t]}static next(t,e){return(t+e)%or.__Length}static toUnitVector(t){switch(t){case or.North:return new ar(0,1);case or.NorthEast:return new ar(1,1);case or.East:return new ar(1,0);case or.SouthEast:return new ar(1,-1);case or.South:return new ar(0,-1);case or.SouthWest:return new ar(-1,-1);case or.West:return new ar(-1,0);case or.NorthWest:return new ar(-1,1);default:throw new TypeError("Illegal enum state")}}}class hr{constructor(t,e){if(t&&e){const n=Rn(1,hr.GENOME_SIZE-1),r=hr.GENOME_SIZE-n;this.geneList=t.getRandomGenes(n).concat(e.getRandomGenes(r))}else this.geneList=Array.from({length:hr.GENOME_SIZE},(()=>Rn(hr.GENE_POOL_SIZE-1)));this.fixGenome()}get randomGene(){const t=Zn(this.geneList);if(void 0===t)throw new RangeError("Invalid genome");return t}toString(){return this.geneList.join("")}getRandomGenes(t){const e=[],n=Dn(0,hr.GENOME_SIZE),r=tr(n);return r.splice(t),r.forEach((t=>e.push(this.geneList[t]))),e}fixGenome(){const t=vn(this.geneList);for(const[e,n]of Object.entries(t))if(0===n){let n=Rn(hr.GENOME_SIZE-1);for(;t[n]<=1;)n=Rn(hr.GENOME_SIZE-1);this.geneList[n]=parseInt(e)}this.geneList.sort()}}hr.GENOME_SIZE=32,hr.GENE_POOL_SIZE=8;class ur extends nr{constructor(t,e,n){if(super(),this.map=t,this.deathDate=null,this._childCount=0,e&&n){const r=e._energy*t.energyPassedToChild,i=n._energy*t.energyPassedToChild;e._energy-=r,n._energy-=i,this._energy=r+i,this._position=e._position,this.myGenes=new hr(e.myGenes,n.myGenes),e._childCount++,n._childCount++}else this._energy=t.startEnergy,this._position=t.getRandomPosition(),this.myGenes=new hr;this.direction=sr.randomDirection,this.birthDay=t.today}move(){if(this.isDead)return;const t=this._position;this._position=this.map.wrapPosition(this._position.add(sr.toUnitVector(this.direction))),this.direction=sr.next(this.direction,this.myGenes.randomGene),super.notifyObservers(t,this._position)}get position(){return this._position}get isDead(){return null!==this.deathDate}get childCount(){return this._childCount}get energy(){return this._energy}set energy(t){this._energy=t,t<=0&&(this.deathDate=this.map.today,this._energy=0)}}class lr{constructor(t,e){this.position=t,this.energy=e}}class cr{constructor(t,e,n,r,i){this.width=t,this.height=e,this.startEnergy=n,this.energyPassedToChild=r,this._today=0;const a=new ar(Math.floor(t*(1-i)/2),Math.floor(e*(1-i)/2)),o=new ar(Math.floor(t*(1+i)/2),Math.floor(e*(1+i)/2));console.log(a,o),this.jungle=new fr(a,o),this.animalMap=new dr(t,e),this.grassMap=new dr(t,e)}nextDay(){this._today++}get today(){return this._today}get jungleBounds(){return[this.jungle.topLeft,this.jungle.bottomRight]}objectAtPosition(t){return this.getAnimal(t)??this.getGrass(t)??null}getRandomPosition(){return new ar(Rn(this.width-1),Rn(this.height-1))}getRandomJunglePosition(){return this.jungle.getRandomPositionInJungle()}wrapPosition(t){const e=(t,e)=>(t%e+e)%e;return new ar(e(t.x,this.width),e(t.y,this.height))}positionChanged(t,e,n){n instanceof ur&&(this.animalMap.delete(t,n),this.animalMap.set(e,n))}putAnimal(t){this.animalMap.set(t.position,t),t.addObserver(this)}putGrass(t){this.grassMap.set(t.position,t)}removeAnimal(t){this.animalMap.delete(t.position,t),t.removeObserver(this)}removeGrass(t){this.grassMap.delete(t.position,t)}getAnimals(t){return this.animalMap.get(t)??null}getAnimal(t){return this.getEntity(this.animalMap,t)}getGrass(t){return this.getEntity(this.grassMap,t)}getEntity(t,e){const n=t.get(e);return n&&n.length>0?n[0]:null}forEachAnimalCell(t){this.animalMap.forEach(((e,n)=>t(e,n)))}forEachGrassCell(t){this.grassMap.forEach(((e,n)=>t(e[0],n)))}}class fr{constructor(t,e){this.topLeft=t,this.bottomRight=e}getRandomPositionInJungle(){return new ar(Rn(this.topLeft.x,this.bottomRight.x),Rn(this.topLeft.y,this.bottomRight.y))}}class dr{constructor(t,e){this.columnCount=t,this.rowCount=e,this.map=new Map}vectorToKey(t){if(t.x>this.columnCount||t.y>this.rowCount)throw new RangeError("Vector not on map");return t.x+t.y*this.columnCount}keyToVector(t){const e=t%this.columnCount,n=(t-e)/this.columnCount;return new ar(e,n)}get(t){return this.map.get(this.vectorToKey(t))}set(t,e){const n=this.get(t);void 0!==n?(n.push(e),n.sort(((t,e)=>t.energy-e.energy))):this.map.set(this.vectorToKey(t),[e])}delete(t,e){const n=this.get(t);return void 0!==n&&(qn(n,(t=>t===e)),0===n.length&&this.map.delete(this.vectorToKey(t)),!0)}has(t){return this.map.has(this.vectorToKey(t))}forEach(t){this.map.forEach(((e,n)=>{t(e,this.keyToVector(n))}))}}class gr{constructor(t){this.animalList=[],this.deadAnimalCount=0,this.totalAnimalAge=0;const{width:e,height:n,startEnergy:r,energyPassedToChild:i,jungleRatio:a,moveEnergy:o,startAnimalCount:s,grassEnergy:h}=t;this.map=new cr(e,n,r,i,a),this.energyToBreed=Math.floor(r/2),this.grassEnergy=h,this.moveEnergy=o,this.populateMap(s)}get aliveAnimals(){return this.animalList.length}get averageAnimalDeathAge(){return this.totalAnimalAge/this.deadAnimalCount||0}get dominatingGenome(){if(0===this.aliveAnimals)return null;const t=this.animalList.map((t=>t.myGenes.toString())),e=Object.entries(vn(t));return e.sort((([,t],[,e])=>t-e)),e[0][0]}populateMap(t){for(let e=0;e<t;e++){const t=new ur(this.map);this.animalList.push(t),this.map.putAnimal(t)}}removeDeadAnimals(){qn(this.animalList,(t=>!!t.isDead&&(this.totalAnimalAge+=this.map.today-t.birthDay,this.deadAnimalCount++,this.map.removeAnimal(t),!0)))}moveAnimals(){this.animalList.forEach((t=>{t.move(),t.energy-=this.moveEnergy}))}breedAnimals(){this.map.forEachAnimalCell((t=>{if(t.length>1){const[e,n]=[t[0],t[1]];if(e.energy>this.energyToBreed&&n.energy>this.energyToBreed){const t=new ur(this.map,e,n);this.map.putAnimal(t),this.animalList.push(t)}}}))}eatGrass(){this.map.forEachAnimalCell(((t,e)=>{const n=this.map.getGrass(e);if(n){t[0].energy+=n.energy,this.map.removeGrass(n)}}))}growGrass(){this.grassGenerator((()=>this.map.getRandomJunglePosition())),this.grassGenerator((()=>this.map.getRandomPosition()))}grassGenerator(t){for(let e=0;e<50;e++){const e=t();if(null===this.map.getGrass(e)){this.map.putGrass(new lr(e,this.grassEnergy));break}}}nextDay(){this.map.nextDay(),this.moveAnimals(),this.removeDeadAnimals(),this.eatGrass(),this.breedAnimals(),this.growGrass()}}const vr=new((br=class extends ir{constructor(){super(),this.canvas=document.querySelector(br.CANVAS_SELECTOR),this.container=document.querySelector(br.CANVAS_CONTAINER_SELECTOR),this.cellWidth=0,this.cellHeight=0,this.map=null,this.highlightedAnimal=null,this.ready=!1;const t=this.canvas.getContext("2d");if(!t)throw new ReferenceError("Cannot get canvas context");this.context2d=t,this.context2d.textAlign="center",this.context2d.textBaseline="middle"}init(){this.ready||(this.attachListeners(),this.ready=!0)}setMap(t){this.map=t,this.handleResize()}update(){this.clear(),this.drawCells(),this.drawBorders()}setHighlightedAnimal(t){this.highlightedAnimal=t}showCanvas(){this.container.style.display=""}hideCanvas(){this.container.style.display="none"}attachListeners(){window.addEventListener("resize",(()=>{this.handleResize(),this.update()})),this.canvas.addEventListener("click",(t=>{t.stopPropagation();const e=this.canvasPosToMapPos([t.offsetX,t.offsetY]);this.notifyObservers(e),console.log(e)}))}clear(){this.context2d.fillStyle="white",this.context2d.fillRect(0,0,this.canvas.width,this.canvas.height)}drawBorders(){this.context2d.beginPath(),this.context2d.rect(0,0,this.canvas.width,this.canvas.height);for(let t=this.cellWidth;t<this.canvas.width;t+=this.cellWidth)this.context2d.moveTo(t,0),this.context2d.lineTo(t,this.canvas.height);for(let t=this.cellHeight;t<this.canvas.height;t+=this.cellHeight)this.context2d.moveTo(0,t),this.context2d.lineTo(this.canvas.width,t);this.context2d.stroke()}drawCells(){this.drawJungleCells(),this.drawGrassCells(),this.drawAnimalCells()}drawGrassCells(){this.map&&(this.context2d.fillStyle="green",this.map.forEachGrassCell(((t,e)=>{const[n,r]=this.mapPosToCanvasPos(e);this.context2d.fillRect(n,r,this.cellWidth,this.cellHeight)})))}drawJungleCells(){if(!this.map)return;const[t,e]=this.map.jungleBounds,[n,r]=this.mapPosToCanvasPos(t),[i,a]=this.mapPosToCanvasPos(e),[o,s]=[i-n+this.cellWidth,a-r+this.cellHeight];this.context2d.fillStyle="lime",this.context2d.fillRect(n,r,o,s)}drawAnimalCells(){if(this.map&&(this.map.forEachAnimalCell(((t,e)=>{this.drawAnimalCell(e,"red",t.length)})),this.highlightedAnimal&&!this.highlightedAnimal.isDead)){const t=this.highlightedAnimal.position;this.drawAnimalCell(t,"orange",this.map.getAnimals(t)?.length)}}drawAnimalCell(t,e,n){this.context2d.fillStyle=e;const[r,i]=this.mapPosToCanvasPos(t);this.context2d.fillRect(r,i,this.cellWidth,this.cellHeight),this.context2d.fillStyle="black",this.context2d.fillText(n?.toFixed()??"0",r+this.cellWidth/2,i+this.cellHeight/2)}mapPosToCanvasPos(t){return[t.x*this.cellWidth,t.y*this.cellHeight]}canvasPosToMapPos([t,e]){const n=Math.floor(t/this.cellWidth),r=Math.floor(e/this.cellHeight);return new ar(n,r)}handleResize(){if(!this.map)return;const[t,e]=[this.container.clientWidth,this.container.clientHeight],n=Math.floor(e/this.map.height)*this.map.height,r=Math.floor(t/this.map.width)*this.map.width,i=this.map.width/this.map.height;this.canvas.height=Math.min(r/i,n),this.canvas.width=Math.min(n*i,r),this.cellWidth=Math.floor(this.canvas.width/this.map.width),this.cellHeight=Math.floor(this.canvas.height/this.map.height)}}).CANVAS_SELECTOR="#canvas",br.CANVAS_CONTAINER_SELECTOR="#canvas-container",br);const pr=new(br=class t extends rr{constructor(){super(),this.ready=!1;const e=localStorage.getItem(t.CONFIG_LS_KEY);this.config=e?JSON.parse(e):t.DEFAULT}init(){this.ready||(this.fillForm(),this.attachListeners(),this.ready=!0)}showForm(){t.formContainer.style.display=""}hideForm(){t.formContainer.style.display="none"}saveConfig(){localStorage.setItem(t.CONFIG_LS_KEY,JSON.stringify(this.config))}fillForm(){Object.entries(this.config).forEach((([t,e])=>{document.querySelector(`input[name=${t}]`).value=`${e}`}))}attachListeners(){t.form.addEventListener("submit",(e=>{e.preventDefault();const n=new FormData(t.form);this.config={width:Number(n.get("width")),height:Number(n.get("height")),startEnergy:Number(n.get("startEnergy")),energyPassedToChild:Number(n.get("energyPassedToChild")),jungleRatio:Number(n.get("jungleRatio")),moveEnergy:Number(n.get("moveEnergy")),startAnimalCount:Number(n.get("startAnimalCount")),grassEnergy:Number(n.get("grassEnergy")),dayLength:Number(n.get("dayLength"))},console.log(this.config),this.saveConfig(),this.notifyObservers(this.config)}))}},br.DEFAULT={width:10,height:10,startEnergy:100,jungleRatio:.3,energyPassedToChild:.5,moveEnergy:10,startAnimalCount:10,grassEnergy:70,dayLength:1e3},br.FORM_CONTAINER_SELECTOR="#form-container",br.FORM_SELECTOR="#config",br.CONFIG_LS_KEY="config",br.form=document.querySelector(br.FORM_SELECTOR),br.formContainer=document.querySelector(br.FORM_CONTAINER_SELECTOR),br);const mr=new((br=class{init(){this.ready||(this.hideSimulation(),vr.addObserver(this),this.ready=!0)}canvasClicked(t){const e=this.simulationEngine?.map.objectAtPosition(t);if(e instanceof ur){const t=window.prompt("Enter a name for the selected animal.");Er.setAnimal(e,t),Er.update(),vr.setHighlightedAnimal(e)}}setConfig(t){this.config=t,this.simulationEngine=new gr(t),vr.setMap(this.simulationEngine.map),_r.setEngine(this.simulationEngine)}get running(){return this._running}showSimulation(){this.simulationContainer.style.display=""}hideSimulation(){this.simulationContainer.style.display="none"}startSimulation(){this.ready&&this.simulationEngine&&(this._running=!0,window.requestAnimationFrame((()=>this.update(performance.now()))))}pauseSimulation(){this._running=!1}toggleSimulation(){this._running?this.pauseSimulation():this.startSimulation()}stopSimulation(){this.pauseSimulation(),window.alert("All animals are dead.")}nextStep(){0===this.simulationEngine?.aliveAnimals&&this.stopSimulation(),this.simulationEngine?.nextDay(),vr.update(),_r.update(),Er.update()}update(t){this._running&&this.config&&(window.requestAnimationFrame((t=>this.update(t))),t-this.lastUpdate>this.config.dayLength&&(this.lastUpdate=t,this.nextStep()))}constructor(){this.simulationContainer=document.querySelector(br.SIMULATION_CONTAINER_SELECTOR),this.simulationEngine=null,this.config=null,this._running=!1,this.lastUpdate=0,this.ready=!1}}).SIMULATION_CONTAINER_SELECTOR="#simulation-container",br);var yr;const _r=new((br=class{setEngine(t){this.engine=t,this.update()}update(){this.simualtionDateSpan.innerText=this.simulationDate(),this.aliveAnimalsSpan.innerText=this.animalsAlive(),this.dominatingGenomeSpan.innerText=this.dominatingGenome(),this.averageLifespanSpan.innerText=this.averageLifespan()}constructor(){this.simualtionDateSpan=document.querySelector(br.SIMULATION_DATE_SELECTOR),this.aliveAnimalsSpan=document.querySelector(br.ALIVE_ANIMALS_SELECTOR),this.dominatingGenomeSpan=document.querySelector(br.DOMINATING_GENOME_SELECTOR),this.averageLifespanSpan=document.querySelector(br.AVERAGE_LIFESPAN_SELECTOR),this.simulationDate=()=>`Day: ${this.engine?.map.today??0}`,this.animalsAlive=()=>`Animals alive curently: ${this.engine?.aliveAnimals??0}`,this.dominatingGenome=()=>`${this.engine?.dominatingGenome??"none"}`,this.averageLifespan=()=>`Average animal lifespan: ${this.engine?.averageAnimalDeathAge.toFixed(2)??0}`,this.engine=null}}).SIMULATION_DATE_SELECTOR="#date",br.ALIVE_ANIMALS_SELECTOR="#alive",br.DOMINATING_GENOME_SELECTOR="#genome",br.AVERAGE_LIFESPAN_SELECTOR="#lifespan",br),Er=new(yr=class t{update(){this._selectedAnimal&&(this.animalNameSpan.innerText=this.animalName(),this.selectedGenomeSpan.innerText=this.animalGenome(),this.childrenCountSpan.innerText=this.animalChildrenCount(),this.animalStatusSpan.innerText=this.animalStatus(),this.animalEnergySpan.innerText=this.animalEnergy(),this._selectedAnimal.isDead&&(this._selectedAnimal=null,window.alert(`${this.name} has died.`)))}setAnimal(e,n){this._selectedAnimal=e,this.name=n||t.DEFAULT_NAME,this.update()}get selectedAnimal(){return this._selectedAnimal}constructor(){this.animalNameSpan=document.querySelector(yr.ANIMAL_NAME_SELECTOR),this.selectedGenomeSpan=document.querySelector(yr.SELECTED_GENOME_SELECTOR),this.childrenCountSpan=document.querySelector(yr.CHILDREN_COUNT_SELECTOR),this.animalStatusSpan=document.querySelector(yr.ANIMAL_STATUS_SELECTOR),this.animalEnergySpan=document.querySelector(yr.ANIMAL_ENERGY_SELECTOR),this.animalName=()=>`Selected animal: ${this.name}`,this.animalGenome=()=>`${this._selectedAnimal?.myGenes.toString()??"none"}`,this.animalChildrenCount=()=>`Children count: ${this._selectedAnimal?.childCount??0}`,this.animalStatus=()=>"Status: "+(this._selectedAnimal?.isDead?"dead":"alive"),this.animalEnergy=()=>`Energy: ${this._selectedAnimal?.energy??0}`,this._selectedAnimal=null,this.name="None"}},yr.DEFAULT_NAME="Mariusz",yr.ANIMAL_NAME_SELECTOR="#animalName",yr.SELECTED_GENOME_SELECTOR="#selectedGenome",yr.CHILDREN_COUNT_SELECTOR="#childrenCount",yr.ANIMAL_STATUS_SELECTOR="#status",yr.ANIMAL_ENERGY_SELECTOR="#energy",yr);var br;(new((br=class{init(){this.ready||(pr.init(),vr.init(),mr.init(),pr.addObserver(this),this.attachListeners(),this.showConfig(),this.ready=!0,console.log("ready"))}configSubmitted(t){this.config=t,this.startSimulation()}startSimulation(){this.config&&(this.showSimulation(),mr.setConfig(this.config),mr.startSimulation(),this.setButtonText())}attachListeners(){this.toggleSimButton.addEventListener("click",(()=>{mr.toggleSimulation(),this.setButtonText()})),this.backToCfgButton.addEventListener("click",(()=>window.location.reload()))}setButtonText(){this.toggleSimButton.innerText=mr.running?"Pause simulation":"Restart simulation"}showSimulation(){pr.hideForm(),mr.showSimulation()}showConfig(){mr.hideSimulation(),pr.showForm()}constructor(){this.toggleSimButton=document.querySelector(br.TOGGLE_SIM_BUTTON_SELECTOR),this.backToCfgButton=document.querySelector(br.BACK_TO_CFG_BUTTON_SELECTOR),this.config=null,this.ready=!1}}).TOGGLE_SIM_BUTTON_SELECTOR="#toggleSim",br.BACK_TO_CFG_BUTTON_SELECTOR="#backToCfg",br)).init();
//# sourceMappingURL=index.95555fce.js.map
